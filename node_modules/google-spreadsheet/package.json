{
  "author": {
    "name": "Theo Ephraim",
    "email": "theozero@gmail.com",
    "url": "http://theoephraim.com"
  },
  "name": "google-spreadsheet",
  "description": "Google Spreadsheets Data API -- simple interface to read/write rows/cells, manage sheets",
  "version": "2.0.2",
  "license": "Unlicense",
  "keywords": [
    "google spreadsheets",
    "google",
    "spreadsheet",
    "spreadsheets",
    "sheets",
    "gdata",
    "api",
    "google sheets"
  ],
  "homepage": "https://github.com/theoephraim/node-google-spreadsheet",
  "repository": {
    "type": "git",
    "url": "git://github.com/theoephraim/node-google-spreadsheet.git"
  },
  "main": "index.js",
  "engines": {
    "node": ">=0.8.0"
  },
  "dependencies": {
    "async": "^1.3.0",
    "google-auth-library": "^0.9.6",
    "lodash": "^3.7.0",
    "request": "^2.69.0",
    "xml2js": "~0.4.0"
  },
  "devDependencies": {
    "chai": "^3.5.0",
    "mocha": "^2.4.5"
  },
  "scripts": {
    "test": "node_modules/.bin/mocha"
  },
  "readme": "# Simple Google Spreadsheet Access (node.js)\n\n[![NPM version](https://badge.fury.io/js/google-spreadsheet.png)](http://badge.fury.io/js/google-spreadsheet)\n\nA simple Node.js module for reading and manipulating data in Google Spreadsheets.\n\n- with or without auth\n- cell-based API - read, write, bulk-updates\n- row-based API - read, update, delete\n- managing worksheets - add, remove, resize, change title\n\n## Installation\n\n[![NPM Info](https://nodei.co/npm/google-spreadsheet.png?downloads=true&downloadRank=true&stars=true)](https://www.npmjs.org/package/google-spreadsheet)\n\n## Basic Usage\n\n_This example is simply meant to show some of the things you can do._\n\nNote (the comments) that many of the calls are actually asynchronous, but I skipped showing the callbacks to make the example shorter. You also don't have to use [async](https://github.com/caolan/async) for control flow, but I find it helpful.\n\n```javascript\nvar GoogleSpreadsheet = require('google-spreadsheet');\nvar async = require('async');\n\n// spreadsheet key is the long id in the sheets URL\nvar doc = new GoogleSpreadsheet('<spreadsheet key>');\nvar sheet;\n\nasync.series([\n  function setAuth(step) {\n    // see notes below for authentication instructions!\n    var creds = require('./google-generated-creds.json');\n    // OR, if you cannot save the file locally (like on heroku)\n    var creds_json = {\n      client_email: 'yourserviceaccountemailhere@google.com',\n      private_key: 'your long private key stuff here'\n    }\n\n    doc.useServiceAccountAuth(creds, step);\n  },\n  function getInfoAndWorksheets(step) {\n    doc.getInfo(function(err, info) {\n      console.log('Loaded doc: '+info.title+' by '+info.author.email);\n      sheet = info.worksheets[0];\n      console.log('sheet 1: '+sheet.title+' '+sheet.rowCount+'x'+sheet.colCount);\n      step();\n    });\n  },\n  function workingWithRows(step) {\n    // google provides some query options\n    sheet.getRows({\n      offset: 1,\n      limit: 20,\n      orderby: 'col2'\n    }, function( err, rows ){\n      console.log('Read '+rows.length+' rows');\n\n      // the row is an object with keys set by the column headers\n      rows[0].colname = 'new val';\n      rows[0].save(); // this is async\n\n      // deleting a row\n      rows[0].del();  // this is async\n\n      step();\n    });\n  },\n  function workingWithCells(step) {\n    sheet.getCells({\n      'min-row': 1,\n      'max-row': 5,\n      'return-empty': true\n    }, function(err, cells) {\n      var cell = cells[0];\n      console.log('Cell R'+cell.row+'C'+cell.col+' = '+cells.value);\n\n      // cells have a value, numericValue, and formula\n      cell.value == '1'\n      cell.numericValue == 1;\n      cell.formula == '=ROW()';\n\n      // updating `value` is \"smart\" and generally handles things for you\n      cell.value = 123;\n      cell.value = '=A1+B2'\n      cell.save(); //async\n\n      // bulk updates make it easy to update many cells at once\n      cells[0].value = 1;\n      cells[1].value = 2;\n      cells[2].formula = '=A1+B1';\n      sheet.bulkUpdateCells(cells); //async\n\n      step();\n    });\n  },\n  function managingSheets(step) {\n    doc.addWorksheet({\n      title: 'my new sheet'\n    }, function(err, sheet) {\n\n      // change a sheet's title\n      sheet.setTitle('new title'); //async\n\n      //resize a sheet\n      sheet.resize({rowCount: 50, colCount: 20}); //async\n\n      sheet.setHeaderRow(['name', 'age', 'phone']); //async\n\n      // removing a worksheet\n      sheet.del(); //async\n\n      step();\n    });\n  }\n]);\n```\n\n## Authentication\n\nIMPORTANT: Google recently deprecated their ClientLogin (username+password)\naccess, so things are slightly more complicated now. Older versions of this\nmodule supported it, so just be aware that things changed.\n\n### Unauthenticated access (read-only access on public docs)\n\nBy default, this module makes unauthenticated requests and can therefore\nonly access spreadsheets that are \"public\".\n\nThe Google Spreadsheets Data API reference and developers guide is a little\nambiguous about how you access a \"published\" public Spreadsheet.\n\nIf you wish to work with a Google Spreadsheet without authenticating, not only\nmust the Spreadsheet in question be visible to the web, but it must also have\nbeen explicitly published using \"File > Publish to the web\" menu option in\nthe google spreadsheets GUI.\n\nMany seemingly \"public\" sheets have not also been \"published\" so this may\ncause some confusion.\n\n\n### Service Account (recommended method)\n\nThis is a 2-legged oauth method and designed to be \"an account that belongs to your application instead of to an individual end user\".\nUse this for an app that needs to access a set of documents that you have full access to.\n([read more](https://developers.google.com/identity/protocols/OAuth2ServiceAccount))\n\n__Setup Instructions__\n\n1. Go to the [Google Developers Console](https://console.developers.google.com/project)\n2. Select your project or create a new one (and then select it)\n3. Enable the Drive API for your project\n  - In the sidebar on the left, expand __APIs & auth__ > __APIs__\n  - Search for \"drive\"\n  - Click on \"Drive API\"\n  - click the blue \"Enable API\" button\n4. Create a service account for your project\n  - In the sidebar on the left, expand __APIs & auth__ > __Credentials__\n  - Click blue \"Add credentials\" button\n  - Select the \"Service account\" option\n  - Select the \"JSON\" key type option\n  - Click blue \"Create\" button\n  - your JSON key file is generated and downloaded to your machine (__it is the only copy!__)\n  - note your service account's email address (also available in the JSON key file)\n5. Share the doc (or docs) with your service account using the email noted above\n\n\n## Google's API Limitations\n\nGoogle's API is somewhat limiting. Calls are made to two differently designed APIs, one made to deal with cells, and one to deal with rows. These APIs will let you manage the data in your sheets, but you cannot make any modifications to the formatting of the cells.\n\n### Row-Based API Limitations\n\nThe row-based API assumes that the \"header row\" (first row) of your sheet is set. They have limitations on the column names they will accept - all lowercase with no symbols or spaces. If the values in your sheet do not follow their rules, their API will adapt the key it actually returns to you. I recommend just following their rules to avoid confusion.\n\nYou _can_ set a formula value into a cell using the row-based API, but when reading rows, you cannot access the formula, or even be aware that there is one in the cell. Any cells with formulas will return the calculated value of the formula. If you try to update a row, the cell with a formula will be overwritten to its calculated value.\n\n**IMPORTANT** The row-based API also assumes there are no empty rows in your sheet. If any row is completely empty, you will not be able to access any rows after the empty row using the row-based API.\n\n-----------------------------------------\n\n## API\n\nThis module follows \"normal\" node callback conventions:\n\n- Every method that takes a callback takes it as its last param\n- Every callback will be called with the error (or null) as first param\n- Some methods have optional params\n\n### `GoogleSpreadsheet`\n\nThe main class that represents an entire spreadsheet.\n\n\n#### `new GoogleSpreadsheet(sheet_id, [auth], [options])`\n\nCreate a new google spreadsheet object.\n\n- `sheet_id` -- the ID of the spreadsheet (from its URL)\n- `auth` - (optional) an existing auth token\n- `options` - (optional)\n  - `visibility` - defaults to `public` if anonymous\n  - `projection` - defaults to `values` if anonymous\n\n\n\n#### `GoogleSpreadsheet.useServiceAccountAuth(account_info, callback)`\n\nUses a service account email and public/private key to create a token to use to authenticated requests.\nNormally you would just pass in the result of requiring the json file that google generates for you when you create a service account.\n\nSee the \"Authentication\" section for more info.\n\nIf you are using heroku or another environment where you cannot save a local file, you may just pass in an object with\n- `client_email` -- your service account's email address\n- `private_key` -- the private key found in the JSON file\n\nInternally, this uses a JWT client to generate a new auth token for your service account that is valid for 1 hour. The token will be automatically regenerated when it expires.\n\n**SPECIAL NOTE FOR HEROKU USERS**\n\n1. Save your private key to a text file\n2. Replace `\\n` with actual line breaks\n3. Replace `\\u003d` with `=`\n4. heroku config:add GOOGLE_PRIVATE_KEY=\"$(cat yourfile.txt)\"\n\n\n\n#### `GoogleSpreadsheet.setAuthToken(id)`\n\nUse an already created auth token for all future requets.\n\n\n\n#### `GoogleSpreadsheet.getInfo(callback)`\n\nGet information about the spreadsheet. Calls callback passing an object that contains:\n\n- `id` - the URL/id as returned from google\n- `title` - the title of the document\n- `updated` - last updated timestamp\n- `author` - auth info in an object\n  - `name` - author name\n  - `email` - author email\n- `worksheets` - an array of `SpreadsheetWorksheet` objects (see below)\n\n\n\n#### `GoogleSpreadsheet.getRows(worksheet_id, options, callback)`\n\nGet an array of row objects from the sheet.\n\n- `worksheet_id` - the index of the sheet to read from (index starts at 1)\n- `options` (optional)\n  - `offset` - start reading from row #\n  - `limit` - max # of rows to read at once\n  - `orderby` - column key to order by\n  - `reverse` - reverse results\n  - `query` - send a structured query for rows ([more info](https://developers.google.com/google-apps/spreadsheets/#sending_a_structured_query_for_rows))\n- `callback(err, rows)` - will be called with an array of row objects (see below)\n\n*NOTE* The `reverse` option only works in conjunction with `orderby`. It will not work to reverse the default ordering. This is a known bug in Google's API.\n\n#### `GoogleSpreadsheet.addRow(worksheet_id, new_row, callback)`\n\nAdd a single row to the sheet.\n\n- `worksheet_id` - the index of the sheet to add to (index starts at 1)\n- `new_row` - key-value object to add - keys must match the header row on your sheet\n- `callback(err)` - callback called after row is added\n\n\n\n#### `GoogleSpreadsheet.getCells(worksheet_id, options, callback)`\n\nGet an array of cell objects.\n\n- `worksheet_id` - the index of the sheet to add to (index starts at 1)\n- `options` (optional)\n  - `min-row` - row range min (uses #s visible on the left)\n  - `max-row` - row range max\n  - `min-col` - column range min (uses numbers, not letters!)\n  - `max-col` - column range max\n  - `return-empty` - include empty cells (boolean)\n\n\n#### `GoogleSpreadsheet.addWorksheet(options, callback)`\n\nAdd a new worksheet to the doc.\n\n- `options` (optional)\n  - `title` - title for the new sheet, must be unique in the doc (default = 'Worksheet {timestamp}')\n  - `rowCount` - number of rows (default = 50)\n  - `colCount` - number of columns (default = 20)\n  - `headers` - array of string keys to put in the first row\n\n#### `GoogleSpreadsheet.removeWorksheet(worksheet_id, callback)`\n\nRemove a worksheet from the doc.\n\n- `worksheet_id` - the index of the sheet to add to (index starts at 1)\n\n----------------------------------\n\n### `SpreadsheetWorksheet`\n\nRepresents a single \"sheet\" from the spreadsheet. These are the different tabs/pages visible at the bottom of the Google Sheets interface.\n\nThese are the sheet objects returned as `worksheets` when calling `GoogleSpreadsheet.getInfo`. Many of the calls are accessible from the main Spreadsheet object by passing in a sheet ID (see above), but some functionality is only available on the Worksheet object because it requires various URLs only known after fetching the sheets for making requests.\n\n__Properties:__\n- `url` - the URL for the sheet\n- `id` - the ID of the sheet\n- `title` - the title (visible on the tabs in google's interface)\n- `rowCount` - number of rows\n- `colCount` - number of columns\n\n### `SpreadsheetWorksheet.getRows(options, callback)`\nSee above.\n\n### `SpreadsheetWorksheet.getCells(options, callback)`\nSee above.\n\n### `SpreadsheetWorksheet.addRow(new_row, callback)`\nSee above.\n\n#### `GoogleSpreadsheet.bulkUpdateCells(cells, callback)`\nDo a bulk update on cells.\n\n- `cells` - an array of SpreadsheetCell objects to save\n\n### `SpreadsheetWorksheet.del(callback)`\nRemove this sheet from the doc.\n\n#### `SpreadsheetWorksheet.setHeaderRow(values, callback)`\nSet the first row of the sheet\n\n- `values` - array of string values to put in the first row of the sheet\n\n#### `SpreadsheetWorksheet.clear(callback)`\nClears the entire sheet's contents\n\n#### `SpreadsheetWorksheet.resize(options, callback)`\nSet the dimensions of the sheet\n\n- `options`\n  - `rowCount` - number of rows\n  - `colCount` - number of columns\n\n#### `SpreadsheetWorksheet.setTitle(title, callback)`\nSet the title of the sheet\n\n- `title` - new title for the worksheet\n\n\n\n----------------------------------\n\n### `SpreadsheetRow`\nRepresents a single row from a sheet.\n\nThese are returned from calling `GoogleSpreadsheet.getRows` and `SpreadsheetWorksheet.getRows`.\n\nYou can treat the row as a normal javascript object. Object keys will be from the header row of your sheet, however the google API mangles the names a bit to make them simpler. It's easiest if you just use all lowercase keys to begin with.\n\nSee limitations above for notes about Google's row-based API!\n\n#### `SpreadsheetRow.save( callback )`\nSaves any changes made to the row's values.\n\n#### `SpreadsheetRow.del( callback )`\nDeletes the row from the sheet.\n\n----------------------------------\n\n### `SpreadsheetCell`\nRepresents a single cell from the sheet.\nUsing cells is the only way to read and modify the formulas in your sheet.\n\n__Properties:__\n- `id` - the ID of the cell\n- `row` - the row this cell is in\n- `col` - the column this cell is in\n- `value` - the value of the cell as a string\n- `formula` - the formula present in the cell, for example `=SUM(A3:B3)` (if applicable)\n- `numericValue` - the value of the cell as a number (if applicable)\n\n__IMPORTANT__:\n- You can modify `value`, `numericValue`, or `formula`, and things will work as expected\n- You can save a cell by either calling `save` or doing a bulk update.\n- Setting `value` or `numericValue` on a cell that contains a formula will clear the formula\n- Setting a `formula` value will clear the `value` and `numericValue` and after saving the values will be updated\n\n#### `SpreadsheetCell.save(callback)`\nSaves the current value or formula\n\n#### `SpreadsheetCell.del(callback)`\nClear the cell -- internally just calls `.setValue('', callback)`\n\n#### `SpreadsheetCell.setValue(val, callback)`\nSets the value and saves it (Just for convenience)\n\n----------------------------------\n\n## Further possibilities & to-do\n- getting list of available spreadsheets for an authenticated user\n- more authentication options\n\n## Links\n- <https://developers.google.com/google-apps/spreadsheets/>\n\n## License\nnode-google-spreadsheets is free and unencumbered public domain software. For more information, see the accompanying UNLICENSE file.\n",
  "readmeFilename": "README.md",
  "bugs": {
    "url": "https://github.com/theoephraim/node-google-spreadsheet/issues"
  },
  "_id": "google-spreadsheet@2.0.2",
  "dist": {
    "shasum": "77be247a76abb04d8a86283f27828c3d2f10501d"
  },
  "_from": "google-spreadsheet@",
  "_resolved": "https://registry.npmjs.org/google-spreadsheet/-/google-spreadsheet-2.0.2.tgz"
}
